<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1301px" height="1021px" viewBox="0 0 1301 1021" content="&lt;mxfile host=&quot;app.diagrams.net&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15&quot; version=&quot;29.5.2&quot;&gt;&#10;  &lt;diagram name=&quot;MCP Tools UML&quot; id=&quot;yqCJaevsnfU7OGJDHYn2&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1081&quot; dy=&quot;619&quot; grid=&quot;0&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;827&quot; pageHeight=&quot;1169&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-1&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1;&quot; value=&quot;C4 Level 4: MCP Tools Component - UML Class Diagram&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;700&quot; x=&quot;450&quot; y=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-2&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;&quot; value=&quot;MCPToolWrapper&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;300&quot; width=&quot;380&quot; x=&quot;40&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-3&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ name: str&amp;#xa;+ description: Optional[str]&amp;#xa;+ mcp_server_url: str&amp;#xa;+ tool_schema: Dict[str, Any]&amp;#xa;+ args_schema: Optional[Type[BaseModel]]&amp;#xa;&amp;#xa;class Config:&amp;#xa;    arbitrary_types_allowed = True&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;380&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-4&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-2&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;380&quot; y=&quot;146&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-5&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ _run(self, **kwargs) -&amp;gt; str&amp;#xa;    &amp;quot;Синхронное выполнение (вызывает _arun)&amp;quot;&amp;#xa;&amp;#xa;+ _arun(self, **kwargs) -&amp;gt; str  &amp;lt;&amp;lt;async&amp;gt;&amp;gt;&amp;#xa;    &amp;quot;Асинхронный вызов MCP инструмента&amp;quot;&amp;#xa;    &amp;quot;Отправляет HTTP POST на mcp_server_url&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;380&quot; y=&quot;154&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-6&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;extends BaseTool (LangChain)&amp;lt;/i&amp;gt;&amp;#xa;Обертка MCP инструмента для LangChain&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;46&quot; width=&quot;380&quot; y=&quot;254&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-7&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#ffe6cc;strokeColor=#d79b00;&quot; value=&quot;&amp;lt;&amp;lt;module&amp;gt;&amp;gt;&amp;#xa;mcp_tool.py&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;260&quot; width=&quot;480&quot; x=&quot;40&quot; y=&quot;460&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-8&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-7&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;480&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-9&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-7&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;&quot; value=&quot;+ json_schema_to_pydantic(schema: Dict[str, Any], &amp;#xa;                         model_name: str = &amp;quot;DynamicModel&amp;quot;)&amp;#xa;    -&amp;gt; Type[BaseModel]&amp;#xa;    &amp;quot;Конвертирует JSON Schema в Pydantic модель&amp;quot;&amp;#xa;    &amp;quot;Используется для args_schema MCPToolWrapper&amp;quot;&amp;#xa;&amp;#xa;&amp;lt;&amp;lt;async&amp;gt;&amp;gt;&amp;#xa;+ create_langchain_tools(mcp_server_url: str) &amp;#xa;    -&amp;gt; List[BaseTool]&amp;#xa;    &amp;quot;Получает список инструментов от MCP сервера&amp;quot;&amp;#xa;    &amp;quot;Создает MCPToolWrapper для каждого инструмента&amp;quot;&amp;#xa;&amp;#xa;+ call_tool(tool_name: str, &amp;#xa;           tools_dict: Dict[str, BaseTool],&amp;#xa;           arguments: Dict[str, Any]) -&amp;gt; Dict[str, Any]&amp;#xa;    &amp;quot;Вызывает инструмент по имени с аргументами&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;212&quot; width=&quot;480&quot; y=&quot;48&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-10&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=3;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;&quot; value=&quot;&amp;lt;&amp;lt;abstract&amp;gt;&amp;gt;&amp;#xa;BaseTool&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;200&quot; width=&quot;280&quot; x=&quot;500&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-11&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-10&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ name: str&amp;#xa;+ description: str&amp;#xa;+ args_schema: Optional[Type[BaseModel]]&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;56&quot; width=&quot;280&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-12&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-10&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;280&quot; y=&quot;96&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-13&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-10&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ _run(self, **kwargs) -&amp;gt; str  &amp;lt;&amp;lt;abstract&amp;gt;&amp;gt;&amp;#xa;+ _arun(self, **kwargs) -&amp;gt; str  &amp;lt;&amp;lt;abstract&amp;gt;&amp;gt;&amp;#xa;+ invoke(input) -&amp;gt; str&amp;#xa;+ ainvoke(input) -&amp;gt; str&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;280&quot; y=&quot;104&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-14&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-10&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;langchain_core.tools&amp;lt;/i&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;26&quot; width=&quot;280&quot; y=&quot;174&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-15&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;&amp;lt;&amp;lt;external&amp;gt;&amp;gt;&amp;#xa;BaseModel&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;200&quot; x=&quot;840&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-16&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-15&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ model_fields: dict&amp;#xa;+ model_config: ConfigDict&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;200&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-17&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-15&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;pydantic&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;200&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-18&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;dashed=1;&quot; value=&quot;&amp;lt;&amp;lt;generated&amp;gt;&amp;gt;&amp;#xa;DynamicModel&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;140&quot; width=&quot;200&quot; x=&quot;840&quot; y=&quot;260&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-19&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-18&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;&quot; value=&quot;+ field_1: type_1&amp;#xa;+ field_2: type_2&amp;#xa;+ ...&amp;#xa;(из JSON Schema)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;200&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-20&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-18&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;Динамически генерируется&amp;#xa;из tool_schema&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;200&quot; y=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-21&quot; parent=&quot;1&quot; style=&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;fontStyle=1;size=20;&quot; value=&quot;MCP Server&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;140&quot; x=&quot;1100&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-22&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;&amp;lt;&amp;lt;JSON Response&amp;gt;&amp;gt;&amp;#xa;MCP Tools List&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;140&quot; width=&quot;180&quot; x=&quot;1080&quot; y=&quot;280&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-23&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-22&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontFamily=Courier New;fontSize=10;&quot; value=&quot;tools: [&amp;#xa;  {&amp;#xa;    name: str,&amp;#xa;    description: str,&amp;#xa;    inputSchema: JSONSchema&amp;#xa;  }, ...&amp;#xa;]&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;180&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-24&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;&amp;lt;&amp;lt;JSON Request&amp;gt;&amp;gt;&amp;#xa;MCP Tool Call&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;180&quot; x=&quot;1080&quot; y=&quot;460&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-25&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-24&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontFamily=Courier New;fontSize=10;&quot; value=&quot;{&amp;#xa;  name: str,&amp;#xa;  arguments: {&amp;#xa;    arg1: value1,&amp;#xa;    ...&amp;#xa;  }&amp;#xa;}&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;180&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-26&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;&quot; value=&quot;&amp;lt;&amp;lt;JSON Schema&amp;gt;&amp;gt;&amp;#xa;Tool Input Schema&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;200&quot; x=&quot;600&quot; y=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-27&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-26&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontFamily=Courier New;fontSize=10;&quot; value=&quot;{&amp;#xa;  &amp;quot;type&amp;quot;: &amp;quot;object&amp;quot;,&amp;#xa;  &amp;quot;properties&amp;quot;: {&amp;#xa;    &amp;quot;param1&amp;quot;: {&amp;quot;type&amp;quot;: &amp;quot;string&amp;quot;},&amp;#xa;    &amp;quot;param2&amp;quot;: {&amp;quot;type&amp;quot;: &amp;quot;integer&amp;quot;}&amp;#xa;  },&amp;#xa;  &amp;quot;required&amp;quot;: [&amp;quot;param1&amp;quot;]&amp;#xa;}&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;200&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-28&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;&quot; value=&quot;Процесс создания инструментов:&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;250&quot; x=&quot;40&quot; y=&quot;760&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-29&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;verticalAlign=top;spacingLeft=10;spacingTop=10;fontSize=11;&quot; value=&quot;1. create_langchain_tools(mcp_server_url)&amp;#xa;   ↓&amp;#xa;2. HTTP GET {mcp_server_url}/tools&amp;#xa;   ↓&amp;#xa;3. Получение списка tools с inputSchema&amp;#xa;   ↓&amp;#xa;4. Для каждого tool:&amp;#xa;   a. json_schema_to_pydantic(inputSchema)&amp;#xa;      → создание Pydantic модели args_schema&amp;#xa;   b. MCPToolWrapper(name, description, &amp;#xa;                    mcp_server_url, tool_schema,&amp;#xa;                    args_schema)&amp;#xa;   ↓&amp;#xa;5. Возврат List[BaseTool]&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;240&quot; width=&quot;320&quot; x=&quot;40&quot; y=&quot;800&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-30&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;&quot; value=&quot;Процесс вызова инструмента:&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;250&quot; x=&quot;400&quot; y=&quot;760&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-31&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;verticalAlign=top;spacingLeft=10;spacingTop=10;fontSize=11;&quot; value=&quot;1. Agent вызывает tool.invoke(arguments)&amp;#xa;   ↓&amp;#xa;2. MCPToolWrapper._run(**kwargs)&amp;#xa;   ↓&amp;#xa;3. MCPToolWrapper._arun(**kwargs)&amp;#xa;   ↓&amp;#xa;4. HTTP POST {mcp_server_url}/call&amp;#xa;   Body: {name: tool_name, arguments: kwargs}&amp;#xa;   ↓&amp;#xa;5. MCP Server выполняет инструмент&amp;#xa;   ↓&amp;#xa;6. Возврат результата (str)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;200&quot; width=&quot;300&quot; x=&quot;400&quot; y=&quot;800&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-32&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-2&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=2;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-10&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-33&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-2&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-15&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;760&quot; y=&quot;175&quot; /&gt;&#10;              &lt;mxPoint x=&quot;760&quot; y=&quot;150&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-34&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;args_schema&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;80&quot; x=&quot;730&quot; y=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-35&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-18&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=2;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-15&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-36&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-7&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-18&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;760&quot; y=&quot;590&quot; /&gt;&#10;              &lt;mxPoint x=&quot;760&quot; y=&quot;330&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-37&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;creates&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;760&quot; y=&quot;450&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-38&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-7&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-2&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-39&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;creates&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;290&quot; y=&quot;420&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-40&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-2&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-21&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;1050&quot; y=&quot;250&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1050&quot; y=&quot;180&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-41&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;HTTP POST&amp;#xa;/call&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;60&quot; x=&quot;1020&quot; y=&quot;200&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-42&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-21&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-22&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-43&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;GET /tools&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;1180&quot; y=&quot;230&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-44&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-24&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-21&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;1170&quot; y=&quot;430&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1280&quot; y=&quot;430&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1280&quot; y=&quot;180&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-45&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;POST /call&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;1280&quot; y=&quot;300&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-46&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;Af80uKnj9ARosEHnqqx1-26&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;Af80uKnj9ARosEHnqqx1-7&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-47&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;input&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;40&quot; x=&quot;560&quot; y=&quot;500&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-48&quot; parent=&quot;1&quot; style=&quot;swimlane;startSize=23;fillColor=#f5f5f5;strokeColor=#666666;&quot; value=&quot;Легенда&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;220&quot; width=&quot;300&quot; x=&quot;760&quot; y=&quot;760&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-49&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;35&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-50&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Основной класс&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;140&quot; x=&quot;40&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-51&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-52&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Абстрактный класс&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;140&quot; x=&quot;40&quot; y=&quot;55&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-53&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;85&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-54&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Модуль с функциями&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;160&quot; x=&quot;40&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-55&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-56&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;JSON Schema&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;140&quot; x=&quot;40&quot; y=&quot;105&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-57&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;dashed=1;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;135&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-58&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Динамически генерируемый&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-59&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;160&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-60&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Внешняя зависимость / API&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;155&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-61&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;size=8;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;18&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;185&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-62&quot; parent=&quot;Af80uKnj9ARosEHnqqx1-48&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;MCP Server&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;140&quot; x=&quot;40&quot; y=&quot;180&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;Af80uKnj9ARosEHnqqx1-63&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;spacingLeft=5;spacingTop=5;fontSize=10;&quot; value=&quot;Файлы:&amp;#xa;sbmagent/tools/mcp_tool.py&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;180&quot; x=&quot;1100&quot; y=&quot;760&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;" resource="https://app.diagrams.net/?src=about#Hpavel-collab%2FAgentic-system-images%2Fmain%2FProjectMCPUML.drawio.svg#%7B%22pageId%22%3A%22yqCJaevsnfU7OGJDHYn2%22%7D"><defs><clipPath id="mx-clip-4-111-372-120-0"><rect x="4" y="111" width="372" height="120"/></clipPath><clipPath id="mx-clip-4-239-372-100-0"><rect x="4" y="239" width="372" height="100"/></clipPath><clipPath id="mx-clip-4-339-372-46-0"><rect x="4" y="339" width="372" height="46"/></clipPath><clipPath id="mx-clip-4-493-472-212-0"><rect x="4" y="493" width="472" height="212"/></clipPath><clipPath id="mx-clip-464-125-272-56-0"><rect x="464" y="125" width="272" height="56"/></clipPath><clipPath id="mx-clip-464-189-272-70-0"><rect x="464" y="189" width="272" height="70"/></clipPath><clipPath id="mx-clip-464-259-272-26-0"><rect x="464" y="259" width="272" height="26"/></clipPath><clipPath id="mx-clip-804-125-192-40-0"><rect x="804" y="125" width="192" height="40"/></clipPath><clipPath id="mx-clip-804-165-192-20-0"><rect x="804" y="165" width="192" height="20"/></clipPath><clipPath id="mx-clip-804-285-192-70-0"><rect x="804" y="285" width="192" height="70"/></clipPath><clipPath id="mx-clip-804-355-192-30-0"><rect x="804" y="355" width="192" height="30"/></clipPath><clipPath id="mx-clip-1044-305-172-100-0"><rect x="1044" y="305" width="172" height="100"/></clipPath><clipPath id="mx-clip-1044-485-172-80-0"><rect x="1044" y="485" width="172" height="80"/></clipPath><clipPath id="mx-clip-564-385-192-120-0"><rect x="564" y="385" width="192" height="120"/></clipPath></defs><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="Af80uKnj9ARosEHnqqx1-1"><g transform="translate(0.5,0.5)"><rect x="410" y="0" width="700" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 698px; height: 1px; padding-top: 20px; margin-left: 411px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 20px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">C4 Level 4: MCP Tools Component - UML Class Diagram</div></div></div></foreignObject><text x="760" y="26" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="20px" text-anchor="middle" font-weight="bold">C4 Level 4: MCP Tools Component - UML Class Diagram</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-2"><g transform="translate(0.5,0.5)"><path d="M 0 106 L 0 80 L 380 80 L 380 106" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 0 106 L 0 380 L 380 380 L 380 106" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 0 106 L 380 106" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="190" y="98">MCPToolWrapper</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-3"><g transform="translate(0.5,0.5)"><rect x="0" y="106" width="380" height="120" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-4-111-372-120-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="124">+ name: str</text><text x="6" y="138">+ description: Optional[str]</text><text x="6" y="152">+ mcp_server_url: str</text><text x="6" y="166">+ tool_schema: Dict[str, Any]</text><text x="6" y="180">+ args_schema: Optional[Type[BaseModel]]</text><text x="6" y="208">class Config:</text><text x="6" y="222">    arbitrary_types_allowed = True</text></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-4"><g transform="translate(0.5,0.5)"><path d="M 0 230 L 380 230" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-5"><g transform="translate(0.5,0.5)"><rect x="0" y="234" width="380" height="100" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-4-239-372-100-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="252">+ _run(self, **kwargs) -&gt; str</text><text x="6" y="266">    "Синхронное выполнение (вызывает _arun)"</text><text x="6" y="294">+ _arun(self, **kwargs) -&gt; str  &lt;&lt;async&gt;&gt;</text><text x="6" y="308">    "Асинхронный вызов MCP инструмента"</text><text x="6" y="322">    "Отправляет HTTP POST на mcp_server_url"</text></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-6"><g transform="translate(0.5,0.5)"><rect x="0" y="334" width="380" height="46" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-4-339-372-46-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="190" y="350">&lt;i&gt;extends BaseTool (LangChain)&lt;/i&gt;</text><text x="190" y="362">Обертка MCP инструмента для LangChain</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-7"><g transform="translate(0.5,0.5)"><path d="M 0 480 L 0 440 L 480 440 L 480 480" fill="#ffe6cc" stroke="#d79b00" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 230, 204), rgb(54, 33, 10)); stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/><path d="M 0 480 L 0 700 L 480 700 L 480 480" fill="none" stroke="#d79b00" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/><path d="M 0 480 L 480 480" fill="none" stroke="#d79b00" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="240" y="458">&lt;&lt;module&gt;&gt;</text><text x="240" y="472">mcp_tool.py</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-8"><g transform="translate(0.5,0.5)"><path d="M 0 484 L 480 484" fill="none" stroke="#d79b00" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-9"><g transform="translate(0.5,0.5)"><rect x="0" y="488" width="480" height="212" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="11px" clip-path="url(#mx-clip-4-493-472-212-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="505">+ json_schema_to_pydantic(schema: Dict[str, Any], </text><text x="6" y="518">                         model_name: str = "DynamicModel")</text><text x="6" y="531">    -&gt; Type[BaseModel]</text><text x="6" y="544">    "Конвертирует JSON Schema в Pydantic модель"</text><text x="6" y="557">    "Используется для args_schema MCPToolWrapper"</text><text x="6" y="583">&lt;&lt;async&gt;&gt;</text><text x="6" y="596">+ create_langchain_tools(mcp_server_url: str) </text><text x="6" y="609">    -&gt; List[BaseTool]</text><text x="6" y="622">    "Получает список инструментов от MCP сервера"</text><text x="6" y="635">    "Создает MCPToolWrapper для каждого инструмента"</text><text x="6" y="661">+ call_tool(tool_name: str, </text><text x="6" y="674">           tools_dict: Dict[str, BaseTool],</text><text x="6" y="687">           arguments: Dict[str, Any]) -&gt; Dict[str, Any]</text><text x="6" y="700">    "Вызывает инструмент по имени с аргументами"</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-10"><g transform="translate(0.5,0.5)"><path d="M 460 120 L 460 80 L 740 80 L 740 120" fill="#e1d5e7" stroke="#9673a6" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(225, 213, 231), rgb(57, 47, 63)); stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/><path d="M 460 120 L 460 280 L 740 280 L 740 120" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/><path d="M 460 120 L 740 120" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="600" y="98">&lt;&lt;abstract&gt;&gt;</text><text x="600" y="112">BaseTool</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-11"><g transform="translate(0.5,0.5)"><rect x="460" y="120" width="280" height="56" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-464-125-272-56-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="466" y="138">+ name: str</text><text x="466" y="152">+ description: str</text><text x="466" y="166">+ args_schema: Optional[Type[BaseModel]]</text></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-12"><g transform="translate(0.5,0.5)"><path d="M 460 180 L 740 180" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-13"><g transform="translate(0.5,0.5)"><rect x="460" y="184" width="280" height="70" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-464-189-272-70-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="466" y="202">+ _run(self, **kwargs) -&gt; str  &lt;&lt;abstract&gt;&gt;</text><text x="466" y="216">+ _arun(self, **kwargs) -&gt; str  &lt;&lt;abstract&gt;&gt;</text><text x="466" y="230">+ invoke(input) -&gt; str</text><text x="466" y="244">+ ainvoke(input) -&gt; str</text></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-14"><g transform="translate(0.5,0.5)"><rect x="460" y="254" width="280" height="26" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-464-259-272-26-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="600" y="270">&lt;i&gt;langchain_core.tools&lt;/i&gt;</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-15"><g transform="translate(0.5,0.5)"><path d="M 800 120 L 800 80 L 1000 80 L 1000 120" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 800 120 L 800 180 L 1000 180 L 1000 120" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 800 120 L 1000 120" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#333333" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(51, 51, 51), rgb(193, 193, 193));"><text x="900" y="98">&lt;&lt;external&gt;&gt;</text><text x="900" y="112">BaseModel</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-16"><g transform="translate(0.5,0.5)"><rect x="800" y="120" width="200" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-804-125-192-40-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="806" y="138">+ model_fields: dict</text><text x="806" y="152">+ model_config: ConfigDict</text></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-17"><g transform="translate(0.5,0.5)"><rect x="800" y="160" width="200" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-804-165-192-20-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="900" y="176">pydantic</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-18"><g transform="translate(0.5,0.5)"><path d="M 800 280 L 800 240 L 1000 240 L 1000 280" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 800 280 L 800 380 L 1000 380 L 1000 280" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 800 280 L 1000 280" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="900" y="258">&lt;&lt;generated&gt;&gt;</text><text x="900" y="272">DynamicModel</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-19"><g transform="translate(0.5,0.5)"><rect x="800" y="280" width="200" height="70" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" font-size="12px" clip-path="url(#mx-clip-804-285-192-70-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="806" y="298">+ field_1: type_1</text><text x="806" y="312">+ field_2: type_2</text><text x="806" y="326">+ ...</text><text x="806" y="340">(из JSON Schema)</text></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-20"><g transform="translate(0.5,0.5)"><rect x="800" y="350" width="200" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-804-355-192-30-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="900" y="366">Динамически генерируется</text><text x="900" y="378">из tool_schema</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-21"><g transform="translate(0.5,0.5)"><path d="M 1080 120 L 1180 120 L 1200 160 L 1180 200 L 1080 200 L 1060 160 Z" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 160px; margin-left: 1061px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">MCP Server</div></div></div></foreignObject><text x="1130" y="164" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">MCP Server</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-22"><g transform="translate(0.5,0.5)"><path d="M 1040 300 L 1040 260 L 1220 260 L 1220 300" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 1040 300 L 1040 400 L 1220 400 L 1220 300" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 1040 300 L 1220 300" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#333333" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(51, 51, 51), rgb(193, 193, 193));"><text x="1130" y="278">&lt;&lt;JSON Response&gt;&gt;</text><text x="1130" y="292">MCP Tools List</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-23"><g transform="translate(0.5,0.5)"><rect x="1040" y="300" width="180" height="100" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="'Courier New'" font-size="10px" clip-path="url(#mx-clip-1044-305-172-100-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="1046" y="316">tools: [</text><text x="1046" y="328">  {</text><text x="1046" y="340">    name: str,</text><text x="1046" y="352">    description: str,</text><text x="1046" y="364">    inputSchema: JSONSchema</text><text x="1046" y="376">  }, ...</text><text x="1046" y="388">]</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-24"><g transform="translate(0.5,0.5)"><path d="M 1040 480 L 1040 440 L 1220 440 L 1220 480" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 1040 480 L 1040 560 L 1220 560 L 1220 480" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 1040 480 L 1220 480" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#333333" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(51, 51, 51), rgb(193, 193, 193));"><text x="1130" y="458">&lt;&lt;JSON Request&gt;&gt;</text><text x="1130" y="472">MCP Tool Call</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-25"><g transform="translate(0.5,0.5)"><rect x="1040" y="480" width="180" height="80" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="'Courier New'" font-size="10px" clip-path="url(#mx-clip-1044-485-172-80-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="1046" y="496">{</text><text x="1046" y="508">  name: str,</text><text x="1046" y="520">  arguments: {</text><text x="1046" y="532">    arg1: value1,</text><text x="1046" y="544">    ...</text><text x="1046" y="556">  }</text><text x="1046" y="568">}</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-26"><g transform="translate(0.5,0.5)"><path d="M 560 380 L 560 340 L 760 340 L 760 380" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 560 380 L 560 500 L 760 500 L 760 380" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 560 380 L 760 380" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="660" y="358">&lt;&lt;JSON Schema&gt;&gt;</text><text x="660" y="372">Tool Input Schema</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-27"><g transform="translate(0.5,0.5)"><rect x="560" y="380" width="200" height="120" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="'Courier New'" font-size="10px" clip-path="url(#mx-clip-564-385-192-120-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="566" y="396">{</text><text x="566" y="408">  "type": "object",</text><text x="566" y="420">  "properties": {</text><text x="566" y="432">    "param1": {"type": "string"},</text><text x="566" y="444">    "param2": {"type": "integer"}</text><text x="566" y="456">  },</text><text x="566" y="468">  "required": ["param1"]</text><text x="566" y="480">}</text></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-28"><g transform="translate(0.5,0.5)"><rect x="0" y="740" width="250" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 755px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Процесс создания инструментов:</div></div></div></foreignObject><text x="2" y="759" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" font-weight="bold">Процесс создания инструментов:</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-29"><g transform="translate(0.5,0.5)"><path d="M 0 780 L 290 780 L 320 810 L 320 1020 L 0 1020 L 0 780 Z" fill="#ffe6cc" stroke="#d79b00" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 230, 204), rgb(54, 33, 10)); stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/><path d="M 290 780 L 290 810 L 320 810 Z" fill-opacity="0.05" fill="#000000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(237, 237, 237));"/><path d="M 290 780 L 290 810 L 320 810" fill="none" stroke="#d79b00" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 308px; height: 1px; padding-top: 797px; margin-left: 12px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1. create_langchain_tools(mcp_server_url)<br />   ↓<br />2. HTTP GET {mcp_server_url}/tools<br />   ↓<br />3. Получение списка tools с inputSchema<br />   ↓<br />4. Для каждого tool:<br />   a. json_schema_to_pydantic(inputSchema)<br />      → создание Pydantic модели args_schema<br />   b. MCPToolWrapper(name, description, <br />                    mcp_server_url, tool_schema,<br />                    args_schema)<br />   ↓<br />5. Возврат List[BaseTool]</div></div></div></foreignObject><text x="12" y="808" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">1. create_langchain_tools(mcp_server_url)...</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-30"><g transform="translate(0.5,0.5)"><rect x="360" y="740" width="250" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 755px; margin-left: 362px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Процесс вызова инструмента:</div></div></div></foreignObject><text x="362" y="759" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" font-weight="bold">Процесс вызова инструмента:</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-31"><g transform="translate(0.5,0.5)"><path d="M 360 780 L 630 780 L 660 810 L 660 980 L 360 980 L 360 780 Z" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 630 780 L 630 810 L 660 810 Z" fill-opacity="0.05" fill="#000000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(237, 237, 237));"/><path d="M 630 780 L 630 810 L 660 810" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 797px; margin-left: 372px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1. Agent вызывает tool.invoke(arguments)<br />   ↓<br />2. MCPToolWrapper._run(**kwargs)<br />   ↓<br />3. MCPToolWrapper._arun(**kwargs)<br />   ↓<br />4. HTTP POST {mcp_server_url}/call<br />   Body: {name: tool_name, arguments: kwargs}<br />   ↓<br />5. MCP Server выполняет инструмент<br />   ↓<br />6. Возврат результата (str)</div></div></div></foreignObject><text x="372" y="808" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">1. Agent вызывает tool.invoke(arguments)...</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-32"><g><path d="M 380 230 L 420 230 L 420 180 L 449.76 180" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 457.76 180 L 449.76 184 L 449.76 176 Z" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-33"><g transform="translate(0.5,0.5)"><path d="M 380 155 L 720 155 L 720 130 L 797.76 130" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 791.88 133.5 L 798.88 130 L 791.88 126.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-34"><g transform="translate(0.5,0.5)"><rect x="690" y="100" width="80" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 110px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">args_schema</div></div></div></foreignObject><text x="730" y="113" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">args_schema</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-35"><g><path d="M 900 240 L 900 190.24" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 900 182.24 L 904 190.24 L 896 190.24 Z" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-36"><g transform="translate(0.5,0.5)"><path d="M 480 570 L 720 570 L 720 310 L 797.76 310" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 791.88 313.5 L 798.88 310 L 791.88 306.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-37"><g transform="translate(0.5,0.5)"><rect x="720" y="430" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 440px; margin-left: 721px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="750" y="443" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-38"><g transform="translate(0.5,0.5)"><path d="M 240 440 L 240 410 L 190 410 L 190 382.24" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 193.5 388.12 L 190 381.12 L 186.5 388.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-39"><g transform="translate(0.5,0.5)"><rect x="250" y="400" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 410px; margin-left: 251px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="280" y="413" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-40"><g transform="translate(0.5,0.5)"><path d="M 380 230 L 1010 230 L 1010 160 L 1057.76 160" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1051.88 163.5 L 1058.88 160 L 1051.88 156.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-41"><g transform="translate(0.5,0.5)"><rect x="980" y="180" width="60" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 195px; margin-left: 981px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">HTTP POST<br />/call</div></div></div></foreignObject><text x="1010" y="198" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">HTTP POST...</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-42"><g transform="translate(0.5,0.5)"><path d="M 1130 200 L 1130 257.76" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1126.5 251.88 L 1130 258.88 L 1133.5 251.88" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-43"><g transform="translate(0.5,0.5)"><rect x="1140" y="210" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 220px; margin-left: 1141px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">GET /tools</div></div></div></foreignObject><text x="1170" y="223" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">GET /tools</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-44"><g transform="translate(0.5,0.5)"><path d="M 1130 440 L 1130 410 L 1240 410 L 1240 160 L 1202.24 160" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1208.12 156.5 L 1201.12 160 L 1208.12 163.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-45"><g transform="translate(0.5,0.5)"><rect x="1240" y="280" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 290px; margin-left: 1241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">POST /call</div></div></div></foreignObject><text x="1270" y="293" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">POST /call</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-46"><g transform="translate(0.5,0.5)"><path d="M 560 420 L 520 420 L 520 570 L 482.24 570" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 488.12 566.5 L 481.12 570 L 488.12 573.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-47"><g transform="translate(0.5,0.5)"><rect x="520" y="480" width="40" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 490px; margin-left: 521px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">input</div></div></div></foreignObject><text x="540" y="493" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">input</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-48"><g transform="translate(0.5,0.5)"><path d="M 720 763 L 720 740 L 1020 740 L 1020 763" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 720 763 L 720 960 L 1020 960 L 1020 763" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 720 763 L 1020 763" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="870" y="756.5">Легенда</text></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-49"><g transform="translate(0.5,0.5)"><rect x="730" y="775" width="20" height="15" fill="#d5e8d4" stroke="#82b366" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-50"><g transform="translate(0.5,0.5)"><rect x="760" y="770" width="140" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 138px; height: 1px; padding-top: 783px; margin-left: 762px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Основной класс</div></div></div></foreignObject><text x="762" y="786" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Основной класс</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-51"><g transform="translate(0.5,0.5)"><rect x="730" y="800" width="20" height="15" fill="#e1d5e7" stroke="#9673a6" pointer-events="all" style="fill: light-dark(rgb(225, 213, 231), rgb(57, 47, 63)); stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-52"><g transform="translate(0.5,0.5)"><rect x="760" y="795" width="140" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 138px; height: 1px; padding-top: 808px; margin-left: 762px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Абстрактный класс</div></div></div></foreignObject><text x="762" y="811" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Абстрактный класс</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-53"><g transform="translate(0.5,0.5)"><rect x="730" y="825" width="20" height="15" fill="#ffe6cc" stroke="#d79b00" pointer-events="all" style="fill: light-dark(rgb(255, 230, 204), rgb(54, 33, 10)); stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-54"><g transform="translate(0.5,0.5)"><rect x="760" y="820" width="160" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 833px; margin-left: 762px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Модуль с функциями</div></div></div></foreignObject><text x="762" y="836" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Модуль с функциями</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-55"><g transform="translate(0.5,0.5)"><rect x="730" y="850" width="20" height="15" fill="#fff2cc" stroke="#d6b656" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-56"><g transform="translate(0.5,0.5)"><rect x="760" y="845" width="140" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 138px; height: 1px; padding-top: 858px; margin-left: 762px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">JSON Schema</div></div></div></foreignObject><text x="762" y="861" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">JSON Schema</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-57"><g transform="translate(0.5,0.5)"><rect x="730" y="875" width="20" height="15" fill="#dae8fc" stroke="#6c8ebf" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-58"><g transform="translate(0.5,0.5)"><rect x="760" y="870" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 883px; margin-left: 762px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Динамически генерируемый</div></div></div></foreignObject><text x="762" y="886" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Динамически генерируемый</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-59"><g transform="translate(0.5,0.5)"><rect x="730" y="900" width="20" height="15" fill="#f5f5f5" stroke="#666666" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-60"><g transform="translate(0.5,0.5)"><rect x="760" y="895" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 908px; margin-left: 762px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Внешняя зависимость / API</div></div></div></foreignObject><text x="762" y="911" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Внешняя зависимость / API</text></switch></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-61"><g transform="translate(0.5,0.5)"><path d="M 738 925 L 742 925 L 750 934 L 742 943 L 738 943 L 730 934 Z" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-62"><g transform="translate(0.5,0.5)"><rect x="760" y="920" width="140" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 138px; height: 1px; padding-top: 933px; margin-left: 762px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">MCP Server</div></div></div></foreignObject><text x="762" y="936" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">MCP Server</text></switch></g></g></g></g><g data-cell-id="Af80uKnj9ARosEHnqqx1-63"><g transform="translate(0.5,0.5)"><path d="M 1060 740 L 1210 740 L 1240 770 L 1240 790 L 1060 790 L 1060 740 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 1210 740 L 1210 770 L 1240 770 Z" fill-opacity="0.05" fill="#000000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(237, 237, 237));"/><path d="M 1210 740 L 1210 770 L 1240 770" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 173px; height: 1px; padding-top: 752px; margin-left: 1067px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Файлы:<br />sbmagent/tools/mcp_tool.py</div></div></div></foreignObject><text x="1067" y="762" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">Файлы:...</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>