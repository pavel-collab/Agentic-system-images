<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1141px" height="881px" viewBox="0 0 1141 881" content="&lt;mxfile host=&quot;app.diagrams.net&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15&quot; version=&quot;29.5.2&quot;&gt;&#10;  &lt;diagram name=&quot;Schemas UML&quot; id=&quot;8WLlxIAvRRo6lHZy0Y9v&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1081&quot; dy=&quot;619&quot; grid=&quot;0&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;827&quot; pageHeight=&quot;1169&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-1&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1;&quot; value=&quot;C4 Level 4: Schemas &amp;amp; Data Models - UML Class Diagram&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;700&quot; x=&quot;350&quot; y=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-2&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;&quot; value=&quot;C4DiagramPlan&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;260&quot; width=&quot;360&quot; x=&quot;40&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-3&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ plant_uml_code: str&amp;#xa;    &amp;quot;Код диаграммы в формате PlantUML&amp;quot;&amp;#xa;&amp;#xa;+ description: str&amp;#xa;    &amp;quot;Описание диаграммы&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;360&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-4&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-2&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;360&quot; y=&quot;106&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-5&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;&quot; value=&quot;Validators:&amp;#xa;&amp;#xa;@field_validator(&amp;#39;plant_uml_code&amp;#39;)&amp;#xa;+ fix_plantuml_syntax(cls, v: str) -&amp;gt; str&amp;#xa;    &amp;quot;Автоматически исправляет синтаксис:&amp;quot;&amp;#xa;    &amp;quot;- Добавляет @startuml/@enduml если нет&amp;quot;&amp;#xa;    &amp;quot;- Исправляет отступы&amp;quot;&amp;#xa;    &amp;quot;- Валидирует структуру&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;360&quot; y=&quot;114&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-6&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;extends BaseModel (Pydantic)&amp;lt;/i&amp;gt;&amp;#xa;Используется для structured output LLM&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;26&quot; width=&quot;360&quot; y=&quot;234&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-7&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;&quot; value=&quot;C4DiagramResponse&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;180&quot; width=&quot;360&quot; x=&quot;40&quot; y=&quot;420&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-8&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-7&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ plant_uml_code: str&amp;#xa;    &amp;quot;Исходный код PlantUML диаграммы&amp;quot;&amp;#xa;&amp;#xa;+ image_path: str&amp;#xa;    &amp;quot;Путь к сгенерированному PNG файлу&amp;quot;&amp;#xa;&amp;#xa;+ description: str&amp;#xa;    &amp;quot;Описание диаграммы&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;360&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-9&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-7&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;360&quot; y=&quot;146&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-10&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-7&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;extends BaseModel (Pydantic)&amp;lt;/i&amp;gt;&amp;#xa;Результат генерации диаграммы&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;26&quot; width=&quot;360&quot; y=&quot;154&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-11&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; value=&quot;AgentState&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;200&quot; width=&quot;380&quot; x=&quot;480&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-12&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-11&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ messages: Annotated[list, add_messages]&amp;#xa;    &amp;quot;Список сообщений агента&amp;quot;&amp;#xa;    &amp;quot;Использует reducer add_messages для&amp;#xa;     автоматического добавления новых сообщений&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;380&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-13&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-11&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;380&quot; y=&quot;106&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-14&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-11&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;&quot; value=&quot;Типы сообщений (langchain_core.messages):&amp;#xa;  - HumanMessage: сообщение пользователя&amp;#xa;  - AIMessage: ответ LLM&amp;#xa;  - ToolMessage: результат инструмента&amp;#xa;  - SystemMessage: системный промпт&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;380&quot; y=&quot;114&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-15&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-11&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;TypedDict (LangGraph)&amp;lt;/i&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;6&quot; width=&quot;380&quot; y=&quot;194&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-16&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;&amp;lt;&amp;lt;external&amp;gt;&amp;gt;&amp;#xa;BaseModel&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;220&quot; x=&quot;920&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-17&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-16&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ model_fields: dict&amp;#xa;+ model_config: ConfigDict&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;220&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-18&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-16&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;220&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-19&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-16&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ model_validate(data) -&amp;gt; Self&amp;#xa;+ model_dump() -&amp;gt; dict&amp;#xa;+ model_json_schema() -&amp;gt; dict&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;56&quot; width=&quot;220&quot; y=&quot;88&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-20&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-16&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;pydantic&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;16&quot; width=&quot;220&quot; y=&quot;144&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-21&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;&amp;lt;&amp;lt;external&amp;gt;&amp;gt;&amp;#xa;TypedDict&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;220&quot; x=&quot;920&quot; y=&quot;300&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-22&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-21&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;&quot; value=&quot;Типизированный словарь Python&amp;#xa;Используется как State в LangGraph&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;220&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-23&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-21&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;typing (Python stdlib)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;220&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; parent=&quot;1&quot; style=&quot;swimlane;startSize=23;fillColor=#fff2cc;strokeColor=#d6b656;&quot; value=&quot;Типы сообщений (LangChain)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;260&quot; width=&quot;380&quot; x=&quot;480&quot; y=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-25&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; style=&quot;swimlane;fontStyle=3;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=35;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;&quot; value=&quot;&amp;lt;&amp;lt;abstract&amp;gt;&amp;gt;&amp;#xa;BaseMessage&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;75&quot; width=&quot;140&quot; x=&quot;120&quot; y=&quot;35&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-26&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-25&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;&quot; value=&quot;+ content: str&amp;#xa;+ type: str&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;140&quot; y=&quot;35&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-27&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=10;&quot; value=&quot;HumanMessage&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;100&quot; x=&quot;20&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-28&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=10;&quot; value=&quot;AIMessage&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;100&quot; x=&quot;140&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-29&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=10;&quot; value=&quot;SystemMessage&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;100&quot; x=&quot;260&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-30&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=10;&quot; value=&quot;ToolMessage&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;100&quot; x=&quot;20&quot; y=&quot;200&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-31&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=10;&quot; value=&quot;AIMessageChunk&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;100&quot; x=&quot;140&quot; y=&quot;200&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-32&quot; edge=&quot;1&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-27&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-25&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-33&quot; edge=&quot;1&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-28&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-25&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-34&quot; edge=&quot;1&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-29&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-25&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-35&quot; edge=&quot;1&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-30&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-25&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;70&quot; y=&quot;125&quot; /&gt;&#10;              &lt;mxPoint x=&quot;120&quot; y=&quot;125&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-36&quot; edge=&quot;1&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-31&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-28&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-37&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-24&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;langchain_core.messages&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;130&quot; x=&quot;240&quot; y=&quot;235&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-38&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#ffe6cc;strokeColor=#d79b00;&quot; value=&quot;&amp;lt;&amp;lt;function&amp;gt;&amp;gt;&amp;#xa;add_messages&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;140&quot; width=&quot;220&quot; x=&quot;920&quot; y=&quot;440&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-39&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-38&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;fontFamily=Courier New;&quot; value=&quot;add_messages(&amp;#xa;    left: list[BaseMessage],&amp;#xa;    right: list[BaseMessage]&amp;#xa;) -&amp;gt; list[BaseMessage]&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;60&quot; width=&quot;220&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-40&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-38&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;Reducer для объединения&amp;#xa;списков сообщений в State&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;220&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-41&quot; parent=&quot;1&quot; style=&quot;swimlane;startSize=23;fillColor=#f5f5f5;strokeColor=#666666;&quot; value=&quot;Пример использования&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;200&quot; width=&quot;400&quot; x=&quot;40&quot; y=&quot;660&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-42&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-41&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=10;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontFamily=Courier New;fontSize=10;&quot; value=&quot;# C4DiagramPlan с LLM structured output&amp;#xa;llm_with_schema = llm.with_structured_output(&amp;#xa;    C4DiagramPlan&amp;#xa;)&amp;#xa;&amp;#xa;result: C4DiagramPlan = llm_with_schema.invoke(&amp;#xa;    &amp;quot;Create C4 context diagram&amp;quot;&amp;#xa;)&amp;#xa;&amp;#xa;# Автоматическая валидация и исправление&amp;#xa;print(result.plant_uml_code)  # Корректный PlantUML&amp;#xa;print(result.description)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;165&quot; width=&quot;390&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-43&quot; parent=&quot;1&quot; style=&quot;swimlane;startSize=23;fillColor=#f5f5f5;strokeColor=#666666;&quot; value=&quot;Пример AgentState в LangGraph&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;200&quot; width=&quot;400&quot; x=&quot;480&quot; y=&quot;660&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-44&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-43&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=10;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontFamily=Courier New;fontSize=10;&quot; value=&quot;# Инициализация state&amp;#xa;initial_state = {&amp;#xa;    &amp;quot;messages&amp;quot;: [HumanMessage(&amp;quot;Hello&amp;quot;)]&amp;#xa;}&amp;#xa;&amp;#xa;# После вызова agent node&amp;#xa;# add_messages автоматически добавляет ответ&amp;#xa;state = {&amp;#xa;    &amp;quot;messages&amp;quot;: [&amp;#xa;        HumanMessage(&amp;quot;Hello&amp;quot;),&amp;#xa;        AIMessage(&amp;quot;Hi! How can I help?&amp;quot;)&amp;#xa;    ]&amp;#xa;}&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;165&quot; width=&quot;390&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-45&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-2&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=2;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-16&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;440&quot; y=&quot;230&quot; /&gt;&#10;              &lt;mxPoint x=&quot;440&quot; y=&quot;60&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1030&quot; y=&quot;60&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-46&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-7&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=2;exitX=1;exitY=0.25;exitDx=0;exitDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-16&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;450&quot; y=&quot;465&quot; /&gt;&#10;              &lt;mxPoint x=&quot;450&quot; y=&quot;50&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1030&quot; y=&quot;50&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-47&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-11&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-21&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-48&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;is a&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;880&quot; y=&quot;270&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-49&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-11&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-38&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;890&quot; y=&quot;250&quot; /&gt;&#10;              &lt;mxPoint x=&quot;890&quot; y=&quot;510&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-50&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;uses reducer&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;90&quot; x=&quot;880&quot; y=&quot;400&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-51&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;c1BjSLBT-vICn77ve9Cm-7&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;&quot; target=&quot;c1BjSLBT-vICn77ve9Cm-2&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-52&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;extends&amp;gt;&amp;gt;&amp;#xa;добавляет image_path&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;120&quot; x=&quot;230&quot; y=&quot;375&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; parent=&quot;1&quot; style=&quot;swimlane;startSize=23;fillColor=#f5f5f5;strokeColor=#666666;&quot; value=&quot;Легенда&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;200&quot; width=&quot;260&quot; x=&quot;920&quot; y=&quot;620&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-54&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;35&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-55&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Pydantic схема (BaseModel)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-56&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-57&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;LangGraph State (TypedDict)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;55&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-58&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;85&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-59&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Message типы (LangChain)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-60&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-61&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Функция / Reducer&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;105&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-62&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;135&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-63&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Абстрактный класс&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-64&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;160&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-65&quot; parent=&quot;c1BjSLBT-vICn77ve9Cm-53&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Внешняя зависимость&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;180&quot; x=&quot;40&quot; y=&quot;155&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;c1BjSLBT-vICn77ve9Cm-66&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;spacingLeft=5;spacingTop=5;fontSize=10;&quot; value=&quot;Файлы:&amp;#xa;sbmagent/schemas/diagrams.py&amp;#xa;sbmagent/schemas/state.py&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;60&quot; width=&quot;180&quot; x=&quot;920&quot; y=&quot;840&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;" resource="https://app.diagrams.net/?src=about#Hpavel-collab%2FAgentic-system-images%2Fmain%2FProjectSchemasUML.drawio.svg#%7B%22pageId%22%3A%228WLlxIAvRRo6lHZy0Y9v%22%7D"><defs><clipPath id="mx-clip-4-111-352-80-0"><rect x="4" y="111" width="352" height="80"/></clipPath><clipPath id="mx-clip-4-199-352-120-0"><rect x="4" y="199" width="352" height="120"/></clipPath><clipPath id="mx-clip-4-319-352-26-0"><rect x="4" y="319" width="352" height="26"/></clipPath><clipPath id="mx-clip-4-431-352-120-0"><rect x="4" y="431" width="352" height="120"/></clipPath><clipPath id="mx-clip-4-559-352-26-0"><rect x="4" y="559" width="352" height="26"/></clipPath><clipPath id="mx-clip-444-111-372-80-0"><rect x="444" y="111" width="372" height="80"/></clipPath><clipPath id="mx-clip-444-199-372-80-0"><rect x="444" y="199" width="372" height="80"/></clipPath><clipPath id="mx-clip-444-279-372-6-0"><rect x="444" y="279" width="372" height="6"/></clipPath><clipPath id="mx-clip-884-125-212-40-0"><rect x="884" y="125" width="212" height="40"/></clipPath><clipPath id="mx-clip-884-173-212-56-0"><rect x="884" y="173" width="212" height="56"/></clipPath><clipPath id="mx-clip-884-229-212-16-0"><rect x="884" y="229" width="212" height="16"/></clipPath><clipPath id="mx-clip-884-325-212-40-0"><rect x="884" y="325" width="212" height="40"/></clipPath><clipPath id="mx-clip-884-365-212-20-0"><rect x="884" y="365" width="212" height="20"/></clipPath><clipPath id="mx-clip-564-415-132-40-0"><rect x="564" y="415" width="132" height="40"/></clipPath><clipPath id="mx-clip-884-465-212-60-0"><rect x="884" y="465" width="212" height="60"/></clipPath><clipPath id="mx-clip-884-525-212-40-0"><rect x="884" y="525" width="212" height="40"/></clipPath><clipPath id="mx-clip-10-675-376-165-0"><rect x="10" y="675" width="376" height="165"/></clipPath><clipPath id="mx-clip-450-675-376-165-0"><rect x="450" y="675" width="376" height="165"/></clipPath></defs><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="c1BjSLBT-vICn77ve9Cm-1"><g transform="translate(0.5,0.5)"><rect x="310" y="0" width="700" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 698px; height: 1px; padding-top: 20px; margin-left: 311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 20px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">C4 Level 4: Schemas &amp; Data Models - UML Class Diagram</div></div></div></foreignObject><text x="660" y="26" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="20px" text-anchor="middle" font-weight="bold">C4 Level 4: Schemas &amp; Data Models - UML Class Diagram</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-2"><g transform="translate(0.5,0.5)"><path d="M 0 106 L 0 80 L 360 80 L 360 106" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 0 106 L 0 340 L 360 340 L 360 106" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 0 106 L 360 106" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="180" y="98">C4DiagramPlan</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-3"><g transform="translate(0.5,0.5)"><rect x="0" y="106" width="360" height="80" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-4-111-352-80-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="124">+ plant_uml_code: str</text><text x="6" y="138">    "Код диаграммы в формате PlantUML"</text><text x="6" y="166">+ description: str</text><text x="6" y="180">    "Описание диаграммы"</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-4"><g transform="translate(0.5,0.5)"><path d="M 0 190 L 360 190" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-5"><g transform="translate(0.5,0.5)"><rect x="0" y="194" width="360" height="120" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="11px" clip-path="url(#mx-clip-4-199-352-120-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="211">Validators:</text><text x="6" y="237">@field_validator('plant_uml_code')</text><text x="6" y="250">+ fix_plantuml_syntax(cls, v: str) -&gt; str</text><text x="6" y="263">    "Автоматически исправляет синтаксис:"</text><text x="6" y="276">    "- Добавляет @startuml/@enduml если нет"</text><text x="6" y="289">    "- Исправляет отступы"</text><text x="6" y="302">    "- Валидирует структуру"</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-6"><g transform="translate(0.5,0.5)"><rect x="0" y="314" width="360" height="26" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-4-319-352-26-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="180" y="330">&lt;i&gt;extends BaseModel (Pydantic)&lt;/i&gt;</text><text x="180" y="342">Используется для structured output LLM</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-7"><g transform="translate(0.5,0.5)"><path d="M 0 426 L 0 400 L 360 400 L 360 426" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 0 426 L 0 580 L 360 580 L 360 426" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 0 426 L 360 426" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="180" y="418">C4DiagramResponse</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-8"><g transform="translate(0.5,0.5)"><rect x="0" y="426" width="360" height="120" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-4-431-352-120-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="444">+ plant_uml_code: str</text><text x="6" y="458">    "Исходный код PlantUML диаграммы"</text><text x="6" y="486">+ image_path: str</text><text x="6" y="500">    "Путь к сгенерированному PNG файлу"</text><text x="6" y="528">+ description: str</text><text x="6" y="542">    "Описание диаграммы"</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-9"><g transform="translate(0.5,0.5)"><path d="M 0 550 L 360 550" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-10"><g transform="translate(0.5,0.5)"><rect x="0" y="554" width="360" height="26" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-4-559-352-26-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="180" y="570">&lt;i&gt;extends BaseModel (Pydantic)&lt;/i&gt;</text><text x="180" y="582">Результат генерации диаграммы</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-11"><g transform="translate(0.5,0.5)"><path d="M 440 106 L 440 80 L 820 80 L 820 106" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 440 106 L 440 280 L 820 280 L 820 106" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 440 106 L 820 106" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="630" y="98">AgentState</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-12"><g transform="translate(0.5,0.5)"><rect x="440" y="106" width="380" height="80" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-444-111-372-80-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="446" y="124">+ messages: Annotated[list, add_messages]</text><text x="446" y="138">    "Список сообщений агента"</text><text x="446" y="152">    "Использует reducer add_messages для</text><text x="446" y="166">     автоматического добавления новых сообщений"</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-13"><g transform="translate(0.5,0.5)"><path d="M 440 190 L 820 190" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-14"><g transform="translate(0.5,0.5)"><rect x="440" y="194" width="380" height="80" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="11px" clip-path="url(#mx-clip-444-199-372-80-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="446" y="211">Типы сообщений (langchain_core.messages):</text><text x="446" y="224">  - HumanMessage: сообщение пользователя</text><text x="446" y="237">  - AIMessage: ответ LLM</text><text x="446" y="250">  - ToolMessage: результат инструмента</text><text x="446" y="263">  - SystemMessage: системный промпт</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-15"><g transform="translate(0.5,0.5)"><rect x="440" y="274" width="380" height="6" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-444-279-372-6-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="630" y="290">&lt;i&gt;TypedDict (LangGraph)&lt;/i&gt;</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-16"><g transform="translate(0.5,0.5)"><path d="M 880 120 L 880 80 L 1100 80 L 1100 120" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 880 120 L 880 240 L 1100 240 L 1100 120" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 880 120 L 1100 120" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#333333" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(51, 51, 51), rgb(193, 193, 193));"><text x="990" y="98">&lt;&lt;external&gt;&gt;</text><text x="990" y="112">BaseModel</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-17"><g transform="translate(0.5,0.5)"><rect x="880" y="120" width="220" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-884-125-212-40-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="886" y="138">+ model_fields: dict</text><text x="886" y="152">+ model_config: ConfigDict</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-18"><g transform="translate(0.5,0.5)"><path d="M 880 164 L 1100 164" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-19"><g transform="translate(0.5,0.5)"><rect x="880" y="168" width="220" height="56" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-884-173-212-56-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="886" y="186">+ model_validate(data) -&gt; Self</text><text x="886" y="200">+ model_dump() -&gt; dict</text><text x="886" y="214">+ model_json_schema() -&gt; dict</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-20"><g transform="translate(0.5,0.5)"><rect x="880" y="224" width="220" height="16" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-884-229-212-16-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="990" y="240">pydantic</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-21"><g transform="translate(0.5,0.5)"><path d="M 880 320 L 880 280 L 1100 280 L 1100 320" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 880 320 L 880 380 L 1100 380 L 1100 320" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 880 320 L 1100 320" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#333333" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(51, 51, 51), rgb(193, 193, 193));"><text x="990" y="298">&lt;&lt;external&gt;&gt;</text><text x="990" y="312">TypedDict</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-22"><g transform="translate(0.5,0.5)"><rect x="880" y="320" width="220" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-884-325-212-40-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="990" y="336">Типизированный словарь Python</text><text x="990" y="348">Используется как State в LangGraph</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-23"><g transform="translate(0.5,0.5)"><rect x="880" y="360" width="220" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-884-365-212-20-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="990" y="376">typing (Python stdlib)</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-24"><g transform="translate(0.5,0.5)"><path d="M 440 363 L 440 340 L 820 340 L 820 363" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 440 363 L 440 600 L 820 600 L 820 363" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 440 363 L 820 363" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="630" y="356.5">Типы сообщений (LangChain)</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-25"><g transform="translate(0.5,0.5)"><path d="M 560 410 L 560 375 L 700 375 L 700 410" fill="#e1d5e7" stroke="#9673a6" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(225, 213, 231), rgb(57, 47, 63)); stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/><path d="M 560 410 L 560 450 L 700 450 L 700 410" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/><path d="M 560 410 L 700 410" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="630" y="393">&lt;&lt;abstract&gt;&gt;</text><text x="630" y="407">BaseMessage</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-26"><g transform="translate(0.5,0.5)"><rect x="560" y="410" width="140" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="10px" clip-path="url(#mx-clip-564-415-132-40-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="566" y="426">+ content: str</text><text x="566" y="438">+ type: str</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-27"><g transform="translate(0.5,0.5)"><rect x="460" y="480" width="100" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 495px; margin-left: 461px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">HumanMessage</div></div></div></foreignObject><text x="510" y="498" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle" font-weight="bold">HumanMessage</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-28"><g transform="translate(0.5,0.5)"><rect x="580" y="480" width="100" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 495px; margin-left: 581px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">AIMessage</div></div></div></foreignObject><text x="630" y="498" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle" font-weight="bold">AIMessage</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-29"><g transform="translate(0.5,0.5)"><rect x="700" y="480" width="100" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 495px; margin-left: 701px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">SystemMessage</div></div></div></foreignObject><text x="750" y="498" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle" font-weight="bold">SystemMessage</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-30"><g transform="translate(0.5,0.5)"><rect x="460" y="540" width="100" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 555px; margin-left: 461px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">ToolMessage</div></div></div></foreignObject><text x="510" y="558" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle" font-weight="bold">ToolMessage</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-31"><g transform="translate(0.5,0.5)"><rect x="580" y="540" width="100" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 555px; margin-left: 581px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">AIMessageChunk</div></div></div></foreignObject><text x="630" y="558" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle" font-weight="bold">AIMessageChunk</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-32"><g transform="translate(0.5,0.5)"><path d="M 510 480 L 510 460 L 580 460 L 580 470 L 630 470 L 630 458.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 630 451.12 L 633.5 458.12 L 626.5 458.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-33"><g transform="translate(0.5,0.5)"><path d="M 630 480 L 630 460 L 630 470 L 630 458.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 630 451.12 L 633.5 458.12 L 626.5 458.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-34"><g transform="translate(0.5,0.5)"><path d="M 750 480 L 750 460 L 680 460 L 680 470 L 630 470 L 630 458.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 630 451.12 L 633.5 458.12 L 626.5 458.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-35"><g transform="translate(0.5,0.5)"><path d="M 510 540 L 510 465 L 560 465 L 560 458.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 560 451.12 L 563.5 458.12 L 556.5 458.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-36"><g transform="translate(0.5,0.5)"><path d="M 630 540 L 630 518.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 630 511.12 L 633.5 518.12 L 626.5 518.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-37"><g transform="translate(0.5,0.5)"><rect x="680" y="575" width="130" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 128px; height: 1px; padding-top: 585px; margin-left: 681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">langchain_core.messages</div></div></div></foreignObject><text x="745" y="588" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">langchain_core.messages</text></switch></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-38"><g transform="translate(0.5,0.5)"><path d="M 880 460 L 880 420 L 1100 420 L 1100 460" fill="#ffe6cc" stroke="#d79b00" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 230, 204), rgb(54, 33, 10)); stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/><path d="M 880 460 L 880 560 L 1100 560 L 1100 460" fill="none" stroke="#d79b00" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/><path d="M 880 460 L 1100 460" fill="none" stroke="#d79b00" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="990" y="438">&lt;&lt;function&gt;&gt;</text><text x="990" y="452">add_messages</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-39"><g transform="translate(0.5,0.5)"><rect x="880" y="460" width="220" height="60" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="'Courier New'" font-size="10px" clip-path="url(#mx-clip-884-465-212-60-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="886" y="476">add_messages(</text><text x="886" y="488">    left: list[BaseMessage],</text><text x="886" y="500">    right: list[BaseMessage]</text><text x="886" y="512">) -&gt; list[BaseMessage]</text></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-40"><g transform="translate(0.5,0.5)"><rect x="880" y="520" width="220" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-884-525-212-40-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="990" y="536">Reducer для объединения</text><text x="990" y="548">списков сообщений в State</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-41"><g transform="translate(0.5,0.5)"><path d="M 0 663 L 0 640 L 400 640 L 400 663" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 0 663 L 0 840 L 400 840 L 400 663" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 0 663 L 400 663" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="200" y="656.5">Пример использования</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-42"><g transform="translate(0.5,0.5)"><rect x="0" y="670" width="390" height="165" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="'Courier New'" font-size="10px" clip-path="url(#mx-clip-10-675-376-165-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="12" y="686"># C4DiagramPlan с LLM structured output</text><text x="12" y="698">llm_with_schema = llm.with_structured_output(</text><text x="12" y="710">    C4DiagramPlan</text><text x="12" y="722">)</text><text x="12" y="746">result: C4DiagramPlan = llm_with_schema.invoke(</text><text x="12" y="758">    "Create C4 context diagram"</text><text x="12" y="770">)</text><text x="12" y="794"># Автоматическая валидация и исправление</text><text x="12" y="806">print(result.plant_uml_code)  # Корректный PlantUML</text><text x="12" y="818">print(result.description)</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-43"><g transform="translate(0.5,0.5)"><path d="M 440 663 L 440 640 L 840 640 L 840 663" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 440 663 L 440 840 L 840 840 L 840 663" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 440 663 L 840 663" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="640" y="656.5">Пример AgentState в LangGraph</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-44"><g transform="translate(0.5,0.5)"><rect x="440" y="670" width="390" height="165" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="'Courier New'" font-size="10px" clip-path="url(#mx-clip-450-675-376-165-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="452" y="686"># Инициализация state</text><text x="452" y="698">initial_state = {</text><text x="452" y="710">    "messages": [HumanMessage("Hello")]</text><text x="452" y="722">}</text><text x="452" y="746"># После вызова agent node</text><text x="452" y="758"># add_messages автоматически добавляет ответ</text><text x="452" y="770">state = {</text><text x="452" y="782">    "messages": [</text><text x="452" y="794">        HumanMessage("Hello"),</text><text x="452" y="806">        AIMessage("Hi! How can I help?")</text><text x="452" y="818">    ]</text><text x="452" y="830">}</text></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-45"><g><path d="M 360 210 L 400 210 L 400 40 L 990 40 L 990 69.76" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 990 77.76 L 986 69.76 L 994 69.76 Z" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-46"><g><path d="M 360 445 L 410 445 L 410 30 L 990 30 L 990 69.76" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 990 77.76 L 986 69.76 L 994 69.76 Z" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-47"><g transform="translate(0.5,0.5)"><path d="M 820 180 L 850 180 L 850 330 L 877.76 330" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 871.88 333.5 L 878.88 330 L 871.88 326.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-48"><g transform="translate(0.5,0.5)"><rect x="840" y="250" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 260px; margin-left: 841px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="870" y="263" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-49"><g transform="translate(0.5,0.5)"><path d="M 820 230 L 850 230 L 850 490 L 877.76 490" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 871.88 493.5 L 878.88 490 L 871.88 486.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-50"><g transform="translate(0.5,0.5)"><rect x="840" y="380" width="90" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 390px; margin-left: 841px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="885" y="393" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-51"><g transform="translate(0.5,0.5)"><path d="M 180 400 L 180 342.24" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 183.5 348.12 L 180 341.12 L 176.5 348.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-52"><g transform="translate(0.5,0.5)"><rect x="190" y="355" width="120" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 370px; margin-left: 191px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;<br />добавляет image_path</div></div></div></foreignObject><text x="250" y="373" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;...</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-53"><g transform="translate(0.5,0.5)"><path d="M 880 623 L 880 600 L 1140 600 L 1140 623" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 880 623 L 880 800 L 1140 800 L 1140 623" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 880 623 L 1140 623" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="1010" y="616.5">Легенда</text></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-54"><g transform="translate(0.5,0.5)"><rect x="890" y="635" width="20" height="15" fill="#d5e8d4" stroke="#82b366" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-55"><g transform="translate(0.5,0.5)"><rect x="920" y="630" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 643px; margin-left: 922px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Pydantic схема (BaseModel)</div></div></div></foreignObject><text x="922" y="646" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Pydantic схема (BaseModel)</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-56"><g transform="translate(0.5,0.5)"><rect x="890" y="660" width="20" height="15" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-57"><g transform="translate(0.5,0.5)"><rect x="920" y="655" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 668px; margin-left: 922px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">LangGraph State (TypedDict)</div></div></div></foreignObject><text x="922" y="671" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">LangGraph State (TypedDict)</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-58"><g transform="translate(0.5,0.5)"><rect x="890" y="685" width="20" height="15" fill="#fff2cc" stroke="#d6b656" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-59"><g transform="translate(0.5,0.5)"><rect x="920" y="680" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 693px; margin-left: 922px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Message типы (LangChain)</div></div></div></foreignObject><text x="922" y="696" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Message типы (LangChain)</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-60"><g transform="translate(0.5,0.5)"><rect x="890" y="710" width="20" height="15" fill="#ffe6cc" stroke="#d79b00" pointer-events="all" style="fill: light-dark(rgb(255, 230, 204), rgb(54, 33, 10)); stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-61"><g transform="translate(0.5,0.5)"><rect x="920" y="705" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 718px; margin-left: 922px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Функция / Reducer</div></div></div></foreignObject><text x="922" y="721" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Функция / Reducer</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-62"><g transform="translate(0.5,0.5)"><rect x="890" y="735" width="20" height="15" fill="#e1d5e7" stroke="#9673a6" pointer-events="all" style="fill: light-dark(rgb(225, 213, 231), rgb(57, 47, 63)); stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-63"><g transform="translate(0.5,0.5)"><rect x="920" y="730" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 743px; margin-left: 922px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Абстрактный класс</div></div></div></foreignObject><text x="922" y="746" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Абстрактный класс</text></switch></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-64"><g transform="translate(0.5,0.5)"><rect x="890" y="760" width="20" height="15" fill="#f5f5f5" stroke="#666666" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-65"><g transform="translate(0.5,0.5)"><rect x="920" y="755" width="180" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 768px; margin-left: 922px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Внешняя зависимость</div></div></div></foreignObject><text x="922" y="771" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Внешняя зависимость</text></switch></g></g></g></g><g data-cell-id="c1BjSLBT-vICn77ve9Cm-66"><g transform="translate(0.5,0.5)"><path d="M 880 820 L 1030 820 L 1060 850 L 1060 880 L 880 880 L 880 820 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 1030 820 L 1030 850 L 1060 850 Z" fill-opacity="0.05" fill="#000000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(237, 237, 237));"/><path d="M 1030 820 L 1030 850 L 1060 850" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 173px; height: 1px; padding-top: 832px; margin-left: 887px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Файлы:<br />sbmagent/schemas/diagrams.py<br />sbmagent/schemas/state.py</div></div></div></foreignObject><text x="887" y="842" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">Файлы:...</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>