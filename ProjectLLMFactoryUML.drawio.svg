<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1221px" height="861px" viewBox="0 0 1221 861" content="&lt;mxfile host=&quot;app.diagrams.net&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15&quot; version=&quot;29.5.2&quot;&gt;&#10;  &lt;diagram name=&quot;LLM Factory UML&quot; id=&quot;spm4G28L7EIdg5D0h4Xp&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1201&quot; dy=&quot;688&quot; grid=&quot;0&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;827&quot; pageHeight=&quot;1169&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-1&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1;&quot; value=&quot;C4 Level 4: LLM Factory Component - UML Class Diagram&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;700&quot; x=&quot;350&quot; y=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-2&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;&quot; value=&quot;&amp;lt;&amp;lt;enumeration&amp;gt;&amp;gt;&amp;#xa;LLMProvider&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;200&quot; x=&quot;40&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-3&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;OPENROUTER = &amp;quot;openrouter&amp;quot;&amp;#xa;OLLAMA = &amp;quot;ollama&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;200&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-4&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-2&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;200&quot; y=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-5&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-2&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;Тип LLM провайдера&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;22&quot; width=&quot;200&quot; y=&quot;98&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-6&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f8cecc;strokeColor=#b85450;&quot; value=&quot;LLMFactoryException&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;200&quot; x=&quot;40&quot; y=&quot;280&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-7&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-6&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;200&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-8&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-6&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;extends Exception&amp;lt;/i&amp;gt;&amp;#xa;Ошибка создания LLM&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;46&quot; width=&quot;200&quot; y=&quot;34&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;&quot; value=&quot;LLMFactory&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;260&quot; width=&quot;400&quot; x=&quot;320&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-10&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;400&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-11&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;&amp;lt;&amp;lt;static&amp;gt;&amp;gt;&amp;#xa;+ get_llm(model_provider: LLMProvider, &amp;#xa;          model_name: str) -&amp;gt; BaseChatModel&amp;#xa;    &amp;quot;Создает экземпляр LLM по типу провайдера&amp;quot;&amp;#xa;&amp;#xa;&amp;lt;&amp;lt;static&amp;gt;&amp;gt;&amp;#xa;+ get_ollama_llm(model_name: str) -&amp;gt; ChatOllama&amp;#xa;    &amp;quot;Создает Ollama LLM клиент&amp;quot;&amp;#xa;&amp;#xa;&amp;lt;&amp;lt;static&amp;gt;&amp;gt;&amp;#xa;+ get_openrouter_llm(model_name: str) -&amp;gt; ChatOpenAI&amp;#xa;    &amp;quot;Создает OpenRouter LLM клиент через ChatOpenAI&amp;quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;180&quot; width=&quot;400&quot; y=&quot;34&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-12&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;fillColor=#d5e8d4;&quot; value=&quot;Паттерн Фабрика для создания LLM клиентов&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;46&quot; width=&quot;400&quot; y=&quot;214&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=3;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;&quot; value=&quot;&amp;lt;&amp;lt;abstract&amp;gt;&amp;gt;&amp;#xa;BaseChatModel&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;280&quot; x=&quot;800&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-14&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ model_name: str&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;26&quot; width=&quot;280&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-15&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;280&quot; y=&quot;66&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-16&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ invoke(messages) -&amp;gt; AIMessage&amp;#xa;+ astream(messages) -&amp;gt; AsyncIterator&amp;#xa;+ bind_tools(tools) -&amp;gt; BaseChatModel&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;56&quot; width=&quot;280&quot; y=&quot;74&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-17&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;langchain_core.language_models&amp;lt;/i&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;280&quot; y=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-18&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; value=&quot;ChatOllama&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;260&quot; x=&quot;800&quot; y=&quot;320&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-19&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-18&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ model: str&amp;#xa;+ base_url: str&amp;#xa;+ temperature: float = 0&amp;#xa;+ format: str | None = None&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;260&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-20&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-18&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;260&quot; y=&quot;96&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-21&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-18&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ invoke(messages) -&amp;gt; AIMessage&amp;#xa;+ astream(messages) -&amp;gt; AsyncIterator&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;36&quot; width=&quot;260&quot; y=&quot;104&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-22&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-18&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;langchain_ollama&amp;lt;/i&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;260&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-23&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; value=&quot;ChatOpenAI&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;180&quot; width=&quot;260&quot; x=&quot;800&quot; y=&quot;520&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-24&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-23&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ model: str&amp;#xa;+ api_key: str&amp;#xa;+ base_url: str&amp;#xa;+ temperature: float = 0&amp;#xa;+ streaming: bool = True&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;86&quot; width=&quot;260&quot; y=&quot;26&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-25&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-23&quot; style=&quot;line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;8&quot; width=&quot;260&quot; y=&quot;112&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-26&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-23&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; value=&quot;+ invoke(messages) -&amp;gt; AIMessage&amp;#xa;+ astream(messages) -&amp;gt; AsyncIterator&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;36&quot; width=&quot;260&quot; y=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-27&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-23&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;&amp;lt;i&amp;gt;langchain_openai (для OpenRouter)&amp;lt;/i&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;24&quot; width=&quot;260&quot; y=&quot;156&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-28&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;&amp;lt;&amp;lt;external&amp;gt;&amp;gt;&amp;#xa;Config&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;180&quot; x=&quot;320&quot; y=&quot;440&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-29&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-28&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;&quot; value=&quot;+ llm: LLMConfig&amp;#xa;  - api_key: SecretStr&amp;#xa;  - base_url: str&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;180&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-30&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-28&quot; style=&quot;text;strokeColor=none;fillColor=none;align=center;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontStyle=2;fontSize=10;&quot; value=&quot;(см. диаграмму Config)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;10&quot; width=&quot;180&quot; y=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-31&quot; parent=&quot;1&quot; style=&quot;shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;Ollama Server&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;100&quot; x=&quot;1140&quot; y=&quot;340&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-32&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=2;&quot; value=&quot;localhost:11434&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;130&quot; x=&quot;1125&quot; y=&quot;420&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-33&quot; parent=&quot;1&quot; style=&quot;shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;&quot; value=&quot;OpenRouter API&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;100&quot; x=&quot;1140&quot; y=&quot;560&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-34&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=2;&quot; value=&quot;openrouter.ai/api/v1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;140&quot; x=&quot;1120&quot; y=&quot;640&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-35&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-2&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-36&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;uses&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;260&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-37&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-6&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;280&quot; y=&quot;230&quot; /&gt;&#10;              &lt;mxPoint x=&quot;280&quot; y=&quot;320&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-38&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;throws&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;240&quot; y=&quot;270&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-39&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-40&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;creates&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;730&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-41&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-18&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=2;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-42&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-23&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=0;strokeWidth=2;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-13&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;930&quot; y=&quot;500&quot; /&gt;&#10;              &lt;mxPoint x=&quot;980&quot; y=&quot;500&quot; /&gt;&#10;              &lt;mxPoint x=&quot;980&quot; y=&quot;260&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-43&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-9&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-28&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-44&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;&amp;lt;&amp;lt;uses&amp;gt;&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;60&quot; x=&quot;430&quot; y=&quot;380&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-45&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-18&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-31&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-46&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;HTTP&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;40&quot; x=&quot;1080&quot; y=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-47&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;ZZg7UPRoXzJDH5VQ_gh5-23&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=open;endFill=0;strokeWidth=1;&quot; target=&quot;ZZg7UPRoXzJDH5VQ_gh5-33&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-48&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;&quot; value=&quot;HTTPS&amp;#xa;API Key&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;50&quot; x=&quot;1080&quot; y=&quot;580&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-49&quot; parent=&quot;1&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;&quot; value=&quot;Последовательность создания LLM:&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;250&quot; x=&quot;40&quot; y=&quot;440&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-50&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;verticalAlign=top;spacingLeft=10;spacingTop=10;fontSize=11;&quot; value=&quot;1. LLMFactory.get_llm(provider, model_name)&amp;#xa;2. Проверка типа провайдера (LLMProvider)&amp;#xa;3. Если OLLAMA: get_ollama_llm(model_name)&amp;#xa;   - Создает ChatOllama с base_url из Config&amp;#xa;4. Если OPENROUTER: get_openrouter_llm(model_name)&amp;#xa;   - Создает ChatOpenAI с api_key из Config&amp;#xa;5. Возвращает BaseChatModel&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;260&quot; x=&quot;40&quot; y=&quot;480&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; parent=&quot;1&quot; style=&quot;swimlane;startSize=23;fillColor=#f5f5f5;strokeColor=#666666;&quot; value=&quot;Легенда&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;200&quot; width=&quot;260&quot; x=&quot;40&quot; y=&quot;680&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-52&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;35&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-53&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Класс-фабрика&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;140&quot; x=&quot;40&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-54&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-55&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Абстрактный класс&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;140&quot; x=&quot;40&quot; y=&quot;55&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-56&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;85&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-57&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Конкретный LLM клиент&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;160&quot; x=&quot;40&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-58&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-59&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Перечисление (Enum)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;140&quot; x=&quot;40&quot; y=&quot;105&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-60&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;135&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-61&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Исключение (Exception)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;160&quot; x=&quot;40&quot; y=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-62&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;15&quot; width=&quot;20&quot; x=&quot;10&quot; y=&quot;160&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-63&quot; parent=&quot;ZZg7UPRoXzJDH5VQ_gh5-51&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;&quot; value=&quot;Внешняя система/зависимость&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;200&quot; x=&quot;40&quot; y=&quot;155&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ZZg7UPRoXzJDH5VQ_gh5-64&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;spacingLeft=5;spacingTop=5;fontSize=10;&quot; value=&quot;Файлы:&amp;#xa;sbmagent/llms/factory.py&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;160&quot; x=&quot;320&quot; y=&quot;680&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;" resource="https://app.diagrams.net/?src=about#Hpavel-collab%2FAgentic-system-images%2Fmain%2FProjectLLMFactoryUML.drawio.svg#%7B%22pageId%22%3A%22spm4G28L7EIdg5D0h4Xp%22%7D"><defs><clipPath id="mx-clip-4-125-192-50-0"><rect x="4" y="125" width="192" height="50"/></clipPath><clipPath id="mx-clip-4-183-192-22-0"><rect x="4" y="183" width="192" height="22"/></clipPath><clipPath id="mx-clip-4-299-192-46-0"><rect x="4" y="299" width="192" height="46"/></clipPath><clipPath id="mx-clip-284-119-392-180-0"><rect x="284" y="119" width="392" height="180"/></clipPath><clipPath id="mx-clip-284-299-392-46-0"><rect x="284" y="299" width="392" height="46"/></clipPath><clipPath id="mx-clip-764-125-272-26-0"><rect x="764" y="125" width="272" height="26"/></clipPath><clipPath id="mx-clip-764-159-272-56-0"><rect x="764" y="159" width="272" height="56"/></clipPath><clipPath id="mx-clip-764-215-272-30-0"><rect x="764" y="215" width="272" height="30"/></clipPath><clipPath id="mx-clip-764-331-252-70-0"><rect x="764" y="331" width="252" height="70"/></clipPath><clipPath id="mx-clip-764-409-252-36-0"><rect x="764" y="409" width="252" height="36"/></clipPath><clipPath id="mx-clip-764-445-252-20-0"><rect x="764" y="445" width="252" height="20"/></clipPath><clipPath id="mx-clip-764-531-252-86-0"><rect x="764" y="531" width="252" height="86"/></clipPath><clipPath id="mx-clip-764-625-252-36-0"><rect x="764" y="625" width="252" height="36"/></clipPath><clipPath id="mx-clip-764-661-252-24-0"><rect x="764" y="661" width="252" height="24"/></clipPath><clipPath id="mx-clip-284-465-172-50-0"><rect x="284" y="465" width="172" height="50"/></clipPath><clipPath id="mx-clip-284-515-172-10-0"><rect x="284" y="515" width="172" height="10"/></clipPath></defs><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-1"><g transform="translate(0.5,0.5)"><rect x="310" y="0" width="700" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 698px; height: 1px; padding-top: 20px; margin-left: 311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 20px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">C4 Level 4: LLM Factory Component - UML Class Diagram</div></div></div></foreignObject><text x="660" y="26" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="20px" text-anchor="middle" font-weight="bold">C4 Level 4: LLM Factory Component - UML Class Diagram</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-2"><g transform="translate(0.5,0.5)"><path d="M 0 120 L 0 80 L 200 80 L 200 120" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 0 120 L 0 200 L 200 200 L 200 120" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 0 120 L 200 120" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="100" y="98">&lt;&lt;enumeration&gt;&gt;</text><text x="100" y="112">LLMProvider</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-3"><g transform="translate(0.5,0.5)"><rect x="0" y="120" width="200" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-4-125-192-50-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="138">OPENROUTER = "openrouter"</text><text x="6" y="152">OLLAMA = "ollama"</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-4"><g transform="translate(0.5,0.5)"><path d="M 0 174 L 200 174" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-5"><g transform="translate(0.5,0.5)"><rect x="0" y="178" width="200" height="22" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-4-183-192-22-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="100" y="194">Тип LLM провайдера</text></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-6"><g transform="translate(0.5,0.5)"><path d="M 0 286 L 0 260 L 200 260 L 200 286" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/><path d="M 0 286 L 0 340 L 200 340 L 200 286" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/><path d="M 0 286 L 200 286" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="100" y="278">LLMFactoryException</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-7"><g transform="translate(0.5,0.5)"><path d="M 0 290 L 200 290" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-8"><g transform="translate(0.5,0.5)"><rect x="0" y="294" width="200" height="46" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-4-299-192-46-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="100" y="310">&lt;i&gt;extends Exception&lt;/i&gt;</text><text x="100" y="322">Ошибка создания LLM</text></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-9"><g transform="translate(0.5,0.5)"><path d="M 280 106 L 280 80 L 680 80 L 680 106" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 280 106 L 280 340 L 680 340 L 680 106" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 280 106 L 680 106" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="480" y="98">LLMFactory</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-10"><g transform="translate(0.5,0.5)"><path d="M 280 110 L 680 110" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-11"><g transform="translate(0.5,0.5)"><rect x="280" y="114" width="400" height="180" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-284-119-392-180-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="286" y="132">&lt;&lt;static&gt;&gt;</text><text x="286" y="146">+ get_llm(model_provider: LLMProvider, </text><text x="286" y="160">          model_name: str) -&gt; BaseChatModel</text><text x="286" y="174">    "Создает экземпляр LLM по типу провайдера"</text><text x="286" y="202">&lt;&lt;static&gt;&gt;</text><text x="286" y="216">+ get_ollama_llm(model_name: str) -&gt; ChatOllama</text><text x="286" y="230">    "Создает Ollama LLM клиент"</text><text x="286" y="258">&lt;&lt;static&gt;&gt;</text><text x="286" y="272">+ get_openrouter_llm(model_name: str) -&gt; ChatOpenAI</text><text x="286" y="286">    "Создает OpenRouter LLM клиент через ChatOpenAI"</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-12"><g transform="translate(0.5,0.5)"><rect x="280" y="294" width="400" height="46" fill="#d5e8d4" stroke="none" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30));"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-284-299-392-46-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="480" y="310">Паттерн Фабрика для создания LLM клиентов</text></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-13"><g transform="translate(0.5,0.5)"><path d="M 760 120 L 760 80 L 1040 80 L 1040 120" fill="#e1d5e7" stroke="#9673a6" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(225, 213, 231), rgb(57, 47, 63)); stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/><path d="M 760 120 L 760 240 L 1040 240 L 1040 120" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/><path d="M 760 120 L 1040 120" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="900" y="98">&lt;&lt;abstract&gt;&gt;</text><text x="900" y="112">BaseChatModel</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-14"><g transform="translate(0.5,0.5)"><rect x="760" y="120" width="280" height="26" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-764-125-272-26-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="766" y="138">+ model_name: str</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-15"><g transform="translate(0.5,0.5)"><path d="M 760 150 L 1040 150" fill="none" stroke="#9673a6" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-16"><g transform="translate(0.5,0.5)"><rect x="760" y="154" width="280" height="56" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-764-159-272-56-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="766" y="172">+ invoke(messages) -&gt; AIMessage</text><text x="766" y="186">+ astream(messages) -&gt; AsyncIterator</text><text x="766" y="200">+ bind_tools(tools) -&gt; BaseChatModel</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-17"><g transform="translate(0.5,0.5)"><rect x="760" y="210" width="280" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-764-215-272-30-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="900" y="226">&lt;i&gt;langchain_core.language_models&lt;/i&gt;</text></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-18"><g transform="translate(0.5,0.5)"><path d="M 760 326 L 760 300 L 1020 300 L 1020 326" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 760 326 L 760 460 L 1020 460 L 1020 326" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 760 326 L 1020 326" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="890" y="318">ChatOllama</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-19"><g transform="translate(0.5,0.5)"><rect x="760" y="326" width="260" height="70" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-764-331-252-70-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="766" y="344">+ model: str</text><text x="766" y="358">+ base_url: str</text><text x="766" y="372">+ temperature: float = 0</text><text x="766" y="386">+ format: str | None = None</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-20"><g transform="translate(0.5,0.5)"><path d="M 760 400 L 1020 400" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-21"><g transform="translate(0.5,0.5)"><rect x="760" y="404" width="260" height="36" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-764-409-252-36-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="766" y="422">+ invoke(messages) -&gt; AIMessage</text><text x="766" y="436">+ astream(messages) -&gt; AsyncIterator</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-22"><g transform="translate(0.5,0.5)"><rect x="760" y="440" width="260" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-764-445-252-20-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="890" y="456">&lt;i&gt;langchain_ollama&lt;/i&gt;</text></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-23"><g transform="translate(0.5,0.5)"><path d="M 760 526 L 760 500 L 1020 500 L 1020 526" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 760 526 L 760 680 L 1020 680 L 1020 526" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/><path d="M 760 526 L 1020 526" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="890" y="518">ChatOpenAI</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-24"><g transform="translate(0.5,0.5)"><rect x="760" y="526" width="260" height="86" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-764-531-252-86-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="766" y="544">+ model: str</text><text x="766" y="558">+ api_key: str</text><text x="766" y="572">+ base_url: str</text><text x="766" y="586">+ temperature: float = 0</text><text x="766" y="600">+ streaming: bool = True</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-25"><g transform="translate(0.5,0.5)"><path d="M 760 616 L 1020 616" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-26"><g transform="translate(0.5,0.5)"><rect x="760" y="620" width="260" height="36" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-764-625-252-36-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="766" y="638">+ invoke(messages) -&gt; AIMessage</text><text x="766" y="652">+ astream(messages) -&gt; AsyncIterator</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-27"><g transform="translate(0.5,0.5)"><rect x="760" y="656" width="260" height="24" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-764-661-252-24-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="890" y="672">&lt;i&gt;langchain_openai (для OpenRouter)&lt;/i&gt;</text></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-28"><g transform="translate(0.5,0.5)"><path d="M 280 460 L 280 420 L 460 420 L 460 460" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 280 460 L 280 520 L 460 520 L 460 460" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 280 460 L 460 460" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#333333" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(51, 51, 51), rgb(193, 193, 193));"><text x="370" y="438">&lt;&lt;external&gt;&gt;</text><text x="370" y="452">Config</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-29"><g transform="translate(0.5,0.5)"><rect x="280" y="460" width="180" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-size="10px" clip-path="url(#mx-clip-284-465-172-50-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="286" y="476">+ llm: LLMConfig</text><text x="286" y="488">  - api_key: SecretStr</text><text x="286" y="500">  - base_url: str</text></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-30"><g transform="translate(0.5,0.5)"><rect x="280" y="510" width="180" height="10" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#000000" font-family="Helvetica" font-style="italic" text-anchor="middle" font-size="10px" clip-path="url(#mx-clip-284-515-172-10-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="370" y="526">(см. диаграмму Config)</text></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-31"><g transform="translate(0.5,0.5)"><path d="M 1100 335 C 1100 326.72 1122.39 320 1150 320 C 1163.26 320 1175.98 321.58 1185.36 324.39 C 1194.73 327.21 1200 331.02 1200 335 L 1200 385 C 1200 393.28 1177.61 400 1150 400 C 1122.39 400 1100 393.28 1100 385 Z" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 1200 335 C 1200 343.28 1177.61 350 1150 350 C 1122.39 350 1100 343.28 1100 335" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 373px; margin-left: 1101px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Ollama Server</div></div></div></foreignObject><text x="1150" y="376" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">Ollama Server</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-32"><g transform="translate(0.5,0.5)"><rect x="1085" y="400" width="130" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 128px; height: 1px; padding-top: 410px; margin-left: 1086px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">localhost:11434</div></div></div></foreignObject><text x="1150" y="413" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle" font-style="italic">localhost:11434</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-33"><g transform="translate(0.5,0.5)"><path d="M 1100 555 C 1100 546.72 1122.39 540 1150 540 C 1163.26 540 1175.98 541.58 1185.36 544.39 C 1194.73 547.21 1200 551.02 1200 555 L 1200 605 C 1200 613.28 1177.61 620 1150 620 C 1122.39 620 1100 613.28 1100 605 Z" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 1200 555 C 1200 563.28 1177.61 570 1150 570 C 1122.39 570 1100 563.28 1100 555" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 593px; margin-left: 1101px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">OpenRouter API</div></div></div></foreignObject><text x="1150" y="596" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">OpenRouter API</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-34"><g transform="translate(0.5,0.5)"><rect x="1080" y="620" width="140" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 630px; margin-left: 1081px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">openrouter.ai/api/v1</div></div></div></foreignObject><text x="1150" y="633" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle" font-style="italic">openrouter.ai/api/v1</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-35"><g transform="translate(0.5,0.5)"><path d="M 280 210 L 240 210 L 240 140 L 202.24 140" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 208.12 136.5 L 201.12 140 L 208.12 143.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-36"><g transform="translate(0.5,0.5)"><rect x="220" y="120" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 130px; margin-left: 221px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="250" y="133" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-37"><g transform="translate(0.5,0.5)"><path d="M 280 210 L 240 210 L 240 300 L 202.24 300" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 208.12 296.5 L 201.12 300 L 208.12 303.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-38"><g transform="translate(0.5,0.5)"><rect x="200" y="250" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 260px; margin-left: 201px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="230" y="263" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-39"><g transform="translate(0.5,0.5)"><path d="M 680 210 L 720 210 L 720 160 L 757.76 160" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 751.88 163.5 L 758.88 160 L 751.88 156.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-40"><g transform="translate(0.5,0.5)"><rect x="690" y="120" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 130px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="720" y="133" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-41"><g><path d="M 890 300 L 890 270 L 900 270 L 900 250.24" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 900 242.24 L 904 250.24 L 896 250.24 Z" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-42"><g><path d="M 890 500 L 890 480 L 940 480 L 940 250.24" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 940 242.24 L 944 250.24 L 936 250.24 Z" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-43"><g transform="translate(0.5,0.5)"><path d="M 480 340 L 480 380 L 370 380 L 370 417.76" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 366.5 411.88 L 370 418.88 L 373.5 411.88" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-44"><g transform="translate(0.5,0.5)"><rect x="390" y="360" width="60" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 370px; margin-left: 391px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">&lt;&gt;</div></div></div></foreignObject><text x="420" y="373" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">&lt;&gt;</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-45"><g transform="translate(0.5,0.5)"><path d="M 1020 380 L 1060 380 L 1060 360 L 1097.76 360" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1091.88 363.5 L 1098.88 360 L 1091.88 356.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-46"><g transform="translate(0.5,0.5)"><rect x="1040" y="340" width="40" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 350px; margin-left: 1041px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">HTTP</div></div></div></foreignObject><text x="1060" y="353" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">HTTP</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-47"><g transform="translate(0.5,0.5)"><path d="M 1020 590 L 1060 590 L 1060 580 L 1097.76 580" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1091.88 583.5 L 1098.88 580 L 1091.88 576.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-48"><g transform="translate(0.5,0.5)"><rect x="1040" y="560" width="50" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 575px; margin-left: 1041px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: normal; word-wrap: normal; ">HTTPS<br />API Key</div></div></div></foreignObject><text x="1065" y="578" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">HTTPS...</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-49"><g transform="translate(0.5,0.5)"><rect x="0" y="420" width="250" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 435px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Последовательность создания LLM:</div></div></div></foreignObject><text x="2" y="439" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" font-weight="bold">Последовательность создания LLM:</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-50"><g transform="translate(0.5,0.5)"><path d="M 0 460 L 230 460 L 260 490 L 260 620 L 0 620 L 0 460 Z" fill="#ffe6cc" stroke="#d79b00" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 230, 204), rgb(54, 33, 10)); stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/><path d="M 230 460 L 230 490 L 260 490 Z" fill-opacity="0.05" fill="#000000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(237, 237, 237));"/><path d="M 230 460 L 230 490 L 260 490" fill="none" stroke="#d79b00" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 477px; margin-left: 12px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1. LLMFactory.get_llm(provider, model_name)<br />2. Проверка типа провайдера (LLMProvider)<br />3. Если OLLAMA: get_ollama_llm(model_name)<br />   - Создает ChatOllama с base_url из Config<br />4. Если OPENROUTER: get_openrouter_llm(model_name)<br />   - Создает ChatOpenAI с api_key из Config<br />5. Возвращает BaseChatModel</div></div></div></foreignObject><text x="12" y="488" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">1. LLMFactory.get_llm(provider, model_name)...</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-51"><g transform="translate(0.5,0.5)"><path d="M 0 683 L 0 660 L 260 660 L 260 683" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 0 683 L 0 860 L 260 860 L 260 683" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/><path d="M 0 683 L 260 683" fill="none" stroke="#666666" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="130" y="676.5">Легенда</text></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-52"><g transform="translate(0.5,0.5)"><rect x="10" y="695" width="20" height="15" fill="#d5e8d4" stroke="#82b366" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-53"><g transform="translate(0.5,0.5)"><rect x="40" y="690" width="140" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 138px; height: 1px; padding-top: 703px; margin-left: 42px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Класс-фабрика</div></div></div></foreignObject><text x="42" y="706" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Класс-фабрика</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-54"><g transform="translate(0.5,0.5)"><rect x="10" y="720" width="20" height="15" fill="#e1d5e7" stroke="#9673a6" pointer-events="all" style="fill: light-dark(rgb(225, 213, 231), rgb(57, 47, 63)); stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-55"><g transform="translate(0.5,0.5)"><rect x="40" y="715" width="140" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 138px; height: 1px; padding-top: 728px; margin-left: 42px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Абстрактный класс</div></div></div></foreignObject><text x="42" y="731" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Абстрактный класс</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-56"><g transform="translate(0.5,0.5)"><rect x="10" y="745" width="20" height="15" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-57"><g transform="translate(0.5,0.5)"><rect x="40" y="740" width="160" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 753px; margin-left: 42px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Конкретный LLM клиент</div></div></div></foreignObject><text x="42" y="756" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Конкретный LLM клиент</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-58"><g transform="translate(0.5,0.5)"><rect x="10" y="770" width="20" height="15" fill="#fff2cc" stroke="#d6b656" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-59"><g transform="translate(0.5,0.5)"><rect x="40" y="765" width="140" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 138px; height: 1px; padding-top: 778px; margin-left: 42px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Перечисление (Enum)</div></div></div></foreignObject><text x="42" y="781" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Перечисление (Enum)</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-60"><g transform="translate(0.5,0.5)"><rect x="10" y="795" width="20" height="15" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-61"><g transform="translate(0.5,0.5)"><rect x="40" y="790" width="160" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 803px; margin-left: 42px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Исключение (Exception)</div></div></div></foreignObject><text x="42" y="806" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Исключение (Exception)</text></switch></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-62"><g transform="translate(0.5,0.5)"><rect x="10" y="820" width="20" height="15" fill="#f5f5f5" stroke="#666666" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(rgb(245, 245, 245), rgb(26, 26, 26)); stroke: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));"/></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-63"><g transform="translate(0.5,0.5)"><rect x="40" y="815" width="200" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 198px; height: 1px; padding-top: 828px; margin-left: 42px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Внешняя система/зависимость</div></div></div></foreignObject><text x="42" y="831" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px">Внешняя система/зависимость</text></switch></g></g></g></g><g data-cell-id="ZZg7UPRoXzJDH5VQ_gh5-64"><g transform="translate(0.5,0.5)"><path d="M 280 660 L 410 660 L 440 690 L 440 710 L 280 710 L 280 660 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 410 660 L 410 690 L 440 690 Z" fill-opacity="0.05" fill="#000000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(237, 237, 237));"/><path d="M 410 660 L 410 690 L 440 690" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 153px; height: 1px; padding-top: 672px; margin-left: 287px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Файлы:<br />sbmagent/llms/factory.py</div></div></div></foreignObject><text x="287" y="682" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">Файлы:...</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>